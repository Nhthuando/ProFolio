generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model portfolios {
  id           String     @id @db.VarChar(36)
  user_id      String     @db.VarChar(36)
  template_id  String?    @db.VarChar(36)
  title        String     @db.VarChar(255)
  slug         String     @unique(map: "slug") @db.VarChar(100)
  custom_theme Json?
  is_published Boolean?   @default(false)
  created_at   DateTime?  @default(now()) @db.Timestamp(0)
  updated_at   DateTime?  @default(now()) @db.Timestamp(0)
  templates    templates? @relation(fields: [template_id], references: [id], onUpdate: NoAction, map: "fk_portfolio_template")
  users        users      @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_portfolio_user")
  projects     projects[]
  sections     sections[]

  @@index([template_id], map: "fk_portfolio_template")
  @@index([user_id], map: "fk_portfolio_user")
}

model projects {
  id            String     @id @db.VarChar(36)
  portfolio_id  String     @db.VarChar(36)
  name          String     @db.VarChar(255)
  description   String?    @db.Text
  thumbnail_url String?    @db.Text
  tech_stack    String?    @db.Text
  project_url   String?    @db.Text
  github_url    String?    @db.Text
  project_order Int?       @default(0)
  portfolios    portfolios @relation(fields: [portfolio_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_project_portfolio")

  @@index([portfolio_id], map: "fk_project_portfolio")
}

model sections {
  id            String     @id @db.VarChar(36)
  portfolio_id  String     @db.VarChar(36)
  section_type  String     @db.VarChar(50)
  section_order Int
  content       Json?
  is_visible    Boolean?   @default(true)
  portfolios    portfolios @relation(fields: [portfolio_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_section_portfolio")

  @@index([portfolio_id], map: "fk_section_portfolio")
}

model templates {
  id            String       @id @db.VarChar(36)
  name          String       @db.VarChar(100)
  thumbnail_url String?      @db.Text
  base_config   Json?
  created_at    DateTime?    @default(now()) @db.Timestamp(0)
  portfolios    portfolios[]
}

model users {
  id            String       @id @db.VarChar(36)
  full_name     String       @db.VarChar(100)
  email         String       @unique(map: "email") @db.VarChar(255)
  password_hash String       @db.VarChar(255)
  avatar_url    String?      @db.Text
  created_at    DateTime?    @default(now()) @db.Timestamp(0)
  portfolios    portfolios[]
}
